

<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <title>Formulaire Image + Signature</title>
  <style>canvas { border: 1px solid black; }</style>
</head>
<body>
  <h2>Formulaire avec image + signature</h2>
  <form id="myForm">
    <label>Nom : <input type="text" name="nom" required></label><br><br>
    <label>Email : <input type="email" name="email" required></label><br><br>
    <label>Photo : <input type="file" id="imageFile" accept="image/*" required></label><br><br>
    <label>Signature :</label><br>
    <canvas id="signature-pad" width="300" height="150"></canvas><br>
    <button type="button" id="clear">Effacer la signature</button><br><br>
    <button type="submit">Envoyer</button>
  </form>

  <script src="https://cdn.jsdelivr.net/npm/signature_pad@4.0.0/dist/signature_pad.umd.min.js"></script>
  <script>
    const canvas = document.getElementById('signature-pad');
    const signaturePad = new SignaturePad(canvas);
    document.getElementById('clear').onclick = () => signaturePad.clear();

    function fileToBase64(file) {
      return new Promise((resolve, reject) => {
        const reader = new FileReader();
        reader.onload = () => resolve(reader.result);
        reader.onerror = e => reject(e);
        reader.readAsDataURL(file);
      });
    }

    document.getElementById('myForm').addEventListener('submit', async e => {
      e.preventDefault();
      if (signaturePad.isEmpty()) {
        alert("Veuillez signer !");
        return;
      }
      const nom = e.target.nom.value;
      const email = e.target.email.value;
      const imageFile = document.getElementById('imageFile').files[0];
      if (!imageFile) {
        alert("Veuillez choisir une image.");
        return;
      }
      try {
        const photoBase64 = await fileToBase64(imageFile);
        const signatureBase64 = signaturePad.toDataURL();

        const data = { nom, email, photo: photoBase64, signature: signatureBase64 };

        const response = await fetch("https://script.google.com/macros/s/AKfycby3wM01Lwr3pAhGazfBGwddJif7UVTe6hLlOi_3aDGH-AJUUiF9BoNzYXTJIR1Wix70/exec", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(data)
        });

        const text = await response.text();
        alert(text);

        e.target.reset();
        signaturePad.clear();

      } catch (err) {
        alert("Erreur : " + err.message);
      }
    });
  </script>
</body>
</html>













